{
  "title": "Academic Equipment Order System - System Audit Report",
  "timestamp": "2026-01-03T14:11:14.853Z",
  "executionTime": "66.08s",
  "summary": {
    "totalTests": 116,
    "passed": 106,
    "failed": 10,
    "skipped": 0
  },
  "suites": [
    {
      "suite": "Authentication & Session",
      "passed": 14,
      "failed": 0,
      "skipped": 0,
      "tests": [
        {
          "name": "A1: Successful login returns JWT token",
          "status": "PASSED",
          "duration": 453
        },
        {
          "name": "A2: Successful login generates audit log",
          "status": "PASSED",
          "duration": 426
        },
        {
          "name": "A3: Failed login (wrong password) is rejected",
          "status": "PASSED",
          "duration": 441
        },
        {
          "name": "A4: Failed login logs with SYSTEM_USER_ID",
          "status": "PASSED",
          "duration": 424
        },
        {
          "name": "A5: Failed login (user not found) is rejected",
          "status": "PASSED",
          "duration": 441
        },
        {
          "name": "A6: User not found logs with SYSTEM_USER_ID",
          "status": "PASSED",
          "duration": 440
        },
        {
          "name": "A7: Missing credentials are rejected",
          "status": "PASSED",
          "duration": 4
        },
        {
          "name": "A8: Token required for protected routes",
          "status": "PASSED",
          "duration": 5
        },
        {
          "name": "A9: Invalid token is rejected",
          "status": "PASSED",
          "duration": 7
        },
        {
          "name": "A10: Malformed token is rejected",
          "status": "PASSED",
          "duration": 6
        },
        {
          "name": "A11: Valid token allows protected route access",
          "status": "PASSED",
          "duration": 438
        },
        {
          "name": "A12: Logout endpoint works with valid token",
          "status": "PASSED",
          "duration": 656
        },
        {
          "name": "A13: Logout generates audit log",
          "status": "PASSED",
          "duration": 448
        },
        {
          "name": "A14: Logout without token fails",
          "status": "PASSED",
          "duration": 5
        }
      ]
    },
    {
      "suite": "Authorization & Access Control",
      "passed": 14,
      "failed": 1,
      "skipped": 0,
      "tests": [
        {
          "name": "B0: Setup - Login all test users",
          "status": "PASSED",
          "duration": 1301
        },
        {
          "name": "B1: Any authenticated user can GET /products",
          "status": "PASSED",
          "duration": 206
        },
        {
          "name": "B2: Unauthenticated user can GET /products",
          "status": "PASSED",
          "duration": 211
        },
        {
          "name": "B3: Any authenticated user can GET /orders",
          "status": "PASSED",
          "duration": 418
        },
        {
          "name": "B4: Unauthenticated user can GET /orders",
          "status": "PASSED",
          "duration": 415
        },
        {
          "name": "B5: Authenticated user can create product",
          "status": "PASSED",
          "duration": 414
        },
        {
          "name": "B6: Unauthenticated user cannot create product",
          "status": "PASSED",
          "duration": 2
        },
        {
          "name": "B7: Authenticated user can create order",
          "status": "PASSED",
          "duration": 1263
        },
        {
          "name": "B8: Unauthenticated user cannot create order",
          "status": "PASSED",
          "duration": 1
        },
        {
          "name": "B9: Authenticated user can approve order",
          "status": "PASSED",
          "duration": 824
        },
        {
          "name": "B10: Unauthenticated user cannot approve order",
          "status": "PASSED",
          "duration": 3
        },
        {
          "name": "B11: Authenticated user can create user",
          "status": "PASSED",
          "duration": 409
        },
        {
          "name": "B12: Unauthenticated user cannot create user",
          "status": "PASSED",
          "duration": 4
        },
        {
          "name": "B13: Document role restrictions (observation)",
          "status": "PASSED",
          "duration": 407
        },
        {
          "name": "B14: Access denial does not modify data",
          "status": "FAILED",
          "error": "Unauthorized product should not exist Expected undefined, got [object Object]",
          "duration": 433
        }
      ]
    },
    {
      "suite": "Core Business Flows",
      "passed": 18,
      "failed": 3,
      "skipped": 0,
      "tests": [
        {
          "name": "C0: Setup - Login test users",
          "status": "PASSED",
          "duration": 844
        },
        {
          "name": "C1: Create product with all fields",
          "status": "PASSED",
          "duration": 415
        },
        {
          "name": "C2: Product status is \"available\" when quantity > 0",
          "status": "PASSED",
          "duration": 206
        },
        {
          "name": "C3: Update product price",
          "status": "PASSED",
          "duration": 611
        },
        {
          "name": "C4: Update product quantity to 0 sets status unavailable",
          "status": "PASSED",
          "duration": 614
        },
        {
          "name": "C5: Update product quantity to positive sets status available",
          "status": "PASSED",
          "duration": 716
        },
        {
          "name": "C6: Create order with single item",
          "status": "PASSED",
          "duration": 1085
        },
        {
          "name": "C7: Order creation reduces product stock",
          "status": "PASSED",
          "duration": 214
        },
        {
          "name": "C8: Cannot order more than available stock",
          "status": "PASSED",
          "duration": 204
        },
        {
          "name": "C9: Get order by ID includes items",
          "status": "PASSED",
          "duration": 405
        },
        {
          "name": "C10: Approve order",
          "status": "PASSED",
          "duration": 396
        },
        {
          "name": "C11: Create order for rejection test",
          "status": "PASSED",
          "duration": 964
        },
        {
          "name": "C12: Reject order restores stock",
          "status": "PASSED",
          "duration": 1561
        },
        {
          "name": "C13: Create order with multiple items",
          "status": "PASSED",
          "duration": 232
        },
        {
          "name": "C14: Create user",
          "status": "PASSED",
          "duration": 401
        },
        {
          "name": "C15: Update user role",
          "status": "FAILED",
          "error": "Should update user Expected 200, got 500",
          "duration": 397
        },
        {
          "name": "C16: Update user email",
          "status": "PASSED",
          "duration": 597
        },
        {
          "name": "C17: Get user by ID",
          "status": "PASSED",
          "duration": 192
        },
        {
          "name": "C18: Delete user",
          "status": "PASSED",
          "duration": 783
        },
        {
          "name": "C19: Delete product",
          "status": "FAILED",
          "error": "Should delete product Expected 200, got 500",
          "duration": 396
        },
        {
          "name": "C20: Deleted product returns 404",
          "status": "FAILED",
          "error": "Should return 404 Expected 404, got 200",
          "duration": 210
        }
      ]
    },
    {
      "suite": "Audit Logging",
      "passed": 25,
      "failed": 4,
      "skipped": 0,
      "tests": [
        {
          "name": "D0: Setup - Login and get baseline log count",
          "status": "PASSED",
          "duration": 1324
        },
        {
          "name": "D1: No existing logs have null user_id",
          "status": "PASSED",
          "duration": 212
        },
        {
          "name": "D2: LOGIN success creates exactly one log",
          "status": "PASSED",
          "duration": 1127
        },
        {
          "name": "D3: LOGIN success log has correct user_id",
          "status": "FAILED",
          "error": "Should have metadata Expected value to exist, got null",
          "duration": 203
        },
        {
          "name": "D4: LOGIN failure log has SYSTEM_USER_ID",
          "status": "PASSED",
          "duration": 928
        },
        {
          "name": "D5: LOGIN metadata structure is correct",
          "status": "PASSED",
          "duration": 208
        },
        {
          "name": "D6: LOGOUT creates audit log",
          "status": "PASSED",
          "duration": 1349
        },
        {
          "name": "D7: LOGOUT log has correct metadata",
          "status": "PASSED",
          "duration": 208
        },
        {
          "name": "D8: CREATE_PRODUCT creates audit log",
          "status": "PASSED",
          "duration": 1123
        },
        {
          "name": "D9: CREATE_PRODUCT log has correct user_id",
          "status": "PASSED",
          "duration": 211
        },
        {
          "name": "D10: CREATE_PRODUCT metadata structure",
          "status": "PASSED",
          "duration": 207
        },
        {
          "name": "D11: UPDATE_PRODUCT creates audit log",
          "status": "PASSED",
          "duration": 1361
        },
        {
          "name": "D12: UPDATE_PRODUCT metadata has field changes",
          "status": "PASSED",
          "duration": 208
        },
        {
          "name": "D13: CREATE_ORDER creates audit log",
          "status": "PASSED",
          "duration": 1821
        },
        {
          "name": "D14: CREATE_ORDER log has customer user_id",
          "status": "PASSED",
          "duration": 216
        },
        {
          "name": "D15: CREATE_ORDER metadata structure",
          "status": "PASSED",
          "duration": 211
        },
        {
          "name": "D16: APPROVE_ORDER creates audit log",
          "status": "PASSED",
          "duration": 1157
        },
        {
          "name": "D17: APPROVE_ORDER metadata structure",
          "status": "PASSED",
          "duration": 214
        },
        {
          "name": "D18: Setup - Create order for rejection test",
          "status": "PASSED",
          "duration": 1054
        },
        {
          "name": "D19: REJECT_ORDER creates audit log",
          "status": "PASSED",
          "duration": 2004
        },
        {
          "name": "D20: REJECT_ORDER metadata has reason",
          "status": "PASSED",
          "duration": 206
        },
        {
          "name": "D21: CREATE_USER creates audit log",
          "status": "PASSED",
          "duration": 1182
        },
        {
          "name": "D22: CREATE_USER metadata structure",
          "status": "PASSED",
          "duration": 233
        },
        {
          "name": "D23: UPDATE_USER creates audit log",
          "status": "FAILED",
          "error": "Should create exactly 1 UPDATE_USER log Expected 1, got 0",
          "duration": 1150
        },
        {
          "name": "D24: DELETE_USER creates audit log",
          "status": "PASSED",
          "duration": 1428
        },
        {
          "name": "D25: DELETE_USER metadata has deleted info",
          "status": "PASSED",
          "duration": 203
        },
        {
          "name": "D26: DELETE_PRODUCT creates audit log",
          "status": "FAILED",
          "error": "Should create exactly 1 DELETE_PRODUCT log Expected 1, got 0",
          "duration": 1120
        },
        {
          "name": "D27: Final check - No null user_ids after all tests",
          "status": "PASSED",
          "duration": 199
        },
        {
          "name": "D28: All action types have at least one log",
          "status": "FAILED",
          "error": "All action types should have logs Expected 0, got 1",
          "duration": 204
        }
      ]
    },
    {
      "suite": "Error Handling & Edge Cases",
      "passed": 21,
      "failed": 1,
      "skipped": 0,
      "tests": [
        {
          "name": "E0: Setup - Login admin",
          "status": "PASSED",
          "duration": 413
        },
        {
          "name": "E1: Missing required fields returns 400",
          "status": "PASSED",
          "duration": 4
        },
        {
          "name": "E2: Invalid product ID returns 404",
          "status": "PASSED",
          "duration": 206
        },
        {
          "name": "E3: Invalid order ID returns 404",
          "status": "PASSED",
          "duration": 202
        },
        {
          "name": "E4: Invalid user ID returns 404",
          "status": "PASSED",
          "duration": 199
        },
        {
          "name": "E5: Non-numeric ID is handled",
          "status": "PASSED",
          "duration": 217
        },
        {
          "name": "E6: Empty order items rejected",
          "status": "PASSED",
          "duration": 5
        },
        {
          "name": "E7: Order with non-existent product rejected",
          "status": "PASSED",
          "duration": 234
        },
        {
          "name": "E8: Duplicate username rejected",
          "status": "PASSED",
          "duration": 244
        },
        {
          "name": "E9: Duplicate email rejected",
          "status": "PASSED",
          "duration": 689
        },
        {
          "name": "E10: Failed product creation does not create log",
          "status": "PASSED",
          "duration": 653
        },
        {
          "name": "E11: Failed order creation does not create log",
          "status": "PASSED",
          "duration": 623
        },
        {
          "name": "E12: Failed user creation does not create log",
          "status": "PASSED",
          "duration": 613
        },
        {
          "name": "E13: Malformed JSON is handled",
          "status": "PASSED",
          "duration": 10
        },
        {
          "name": "E14: Extra fields are ignored",
          "status": "PASSED",
          "duration": 434
        },
        {
          "name": "E15: Update non-existent product returns 404",
          "status": "PASSED",
          "duration": 209
        },
        {
          "name": "E16: Delete non-existent product returns 404",
          "status": "PASSED",
          "duration": 210
        },
        {
          "name": "E17: Approve non-existent order returns 404",
          "status": "PASSED",
          "duration": 195
        },
        {
          "name": "E18: Server responds after error",
          "status": "PASSED",
          "duration": 381
        },
        {
          "name": "E19: 404 endpoint handled",
          "status": "PASSED",
          "duration": 2
        },
        {
          "name": "E20: Negative quantity handled",
          "status": "PASSED",
          "duration": 390
        },
        {
          "name": "E21: Negative price handled",
          "status": "FAILED",
          "error": "Should either create or reject Expected true, got false",
          "duration": 197
        }
      ]
    },
    {
      "suite": "Data Consistency & Integrity",
      "passed": 14,
      "failed": 1,
      "skipped": 0,
      "tests": [
        {
          "name": "F0: Setup - Login and create test product",
          "status": "PASSED",
          "duration": 1143
        },
        {
          "name": "F1: Order reduces inventory correctly",
          "status": "PASSED",
          "duration": -23
        },
        {
          "name": "F2: Multiple orders track cumulative inventory",
          "status": "PASSED",
          "duration": 2329
        },
        {
          "name": "F3: Rejected order restores correct quantity",
          "status": "PASSED",
          "duration": 2825
        },
        {
          "name": "F4: Approved order does not restore stock",
          "status": "PASSED",
          "duration": 1860
        },
        {
          "name": "F5: Order items stored correctly",
          "status": "PASSED",
          "duration": 1470
        },
        {
          "name": "F6: Order totalAmount matches calculation",
          "status": "PASSED",
          "duration": 1048
        },
        {
          "name": "F7: Order status transitions correctly",
          "status": "PASSED",
          "duration": 1539
        },
        {
          "name": "F8: Logs reference valid user IDs",
          "status": "PASSED",
          "duration": 418
        },
        {
          "name": "F9: Product creation log references existing product",
          "status": "PASSED",
          "duration": 1034
        },
        {
          "name": "F10: Order creation log references existing order",
          "status": "PASSED",
          "duration": 1838
        },
        {
          "name": "F11: Product status reflects quantity",
          "status": "PASSED",
          "duration": 210
        },
        {
          "name": "F12: All users have required fields",
          "status": "PASSED",
          "duration": 206
        },
        {
          "name": "F13: All user roles are valid",
          "status": "FAILED",
          "error": "All roles should be valid Expected 0, got 2",
          "duration": 203
        },
        {
          "name": "F14: Cleanup - Delete test product",
          "status": "PASSED",
          "duration": 401
        }
      ]
    }
  ],
  "assessment": {
    "readinessLevel": "MVP with Caveats",
    "readinessNotes": [
      "Multiple issues require attention",
      "Not recommended for production without fixes"
    ],
    "findings": {
      "securityConcerns": [],
      "missingValidations": [],
      "brokenFeatures": [
        "Audit: D3: LOGIN success log has correct user_id",
        "Audit: D23: UPDATE_USER creates audit log",
        "Audit: D26: DELETE_PRODUCT creates audit log",
        "Audit: D28: All action types have at least one log"
      ],
      "recommendations": [
        "Review all failed tests and fix issues",
        "Ensure SYSTEM user (id=0) exists for unauthenticated logging",
        "Consider adding rate limiting for login attempts",
        "Implement bcrypt for password hashing (currently plaintext)",
        "Add role-based restrictions to admin operations"
      ]
    }
  }
}